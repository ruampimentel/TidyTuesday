---
title: "TidyTemplate"
date: 2022-02-10
output: html_output
---

# TidyTuesday


```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(tidytuesdayR)

```

# Load the weekly Data


```{r Load}

tt <- tt_load("2022-02-08")

```


# Readme

Take a look at the readme for the weekly data to get insight on the dataset.
This includes a data dictionary, source, and a link to an article on the data.

```{r Readme, eval = interactive()}

tt

```


# Glimpse Data

Take an initial look at the format of the data available.

```{r Glimpse}

tt %>% 
  map(glimpse)

```

# Wrangle

Explore the data and process it into a nice format for plotting! Access each dataset by name by using a dollarsign after the `tt` object and then the name of the data set.

```{r Wrangle}

airmen <- tt$airmen

airmen %>% glimpse()

airmen <- airmen %>% 
  mutate(
    across(rank_at_graduation:aerial_victory_credits, factor)
  ) 

airmen %>% 
  filter(reported_lost == "Y") %>% 
  select(name, last_name, starts_with("reported"))

```


# Visualize

Using your processed dataset, create your unique visualization.

```{r Visualize}

state_count <- airmen %>% 
  count(state)
  

state_count %>% 
  arrange(-n) %>% 
  mutate(state = fct_reorder(state, -n)) %>% 
  filter(n>=37) %>% 
  ggplot(aes(x = state, y = n, fill = -n)) +
  geom_bar(stat = "identity") +
  theme_light() +
  theme(legend.position = "none") +
  labs(title = "Number of Airmen by US states",
       x = "State",
       y = "Number of Airmen")

state_count %>% 
  filter(is.na(state))

library(forcats)

airmen %>% 
  mutate(state = fct_reorder(state, state, count)) %>% 
  ggplot(aes(x = state, fill = state)) +
  geom_bar() +
  theme_classic()

```

# Save Image

Save your image for sharing. Be sure to use the `#TidyTuesday` hashtag in your post on twitter! 

```{r}

# This will save your most recent plot
ggsave(
  filename = "My TidyTuesday Plot.png",
  device = "png")

```
