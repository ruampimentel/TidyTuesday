---
title: "TidyTemplate"
date: 2021-05-29
output: html_output
---

# TidyTuesday


```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(tidytuesdayR)


library(ggthemes)

theme_set(theme_light())

```

# Load the weekly Data

Dowload the weekly data and make available in the `tt` object.

```{r Load}

tt <- tt_load("2021-05-25")

```


# Readme

Take a look at the readme for the weekly data to get insight on the dataset.
This includes a data dictionary, source, and a link to an article on the data.

```{r Readme, eval = interactive()}

tt

```


# Glimpse Data

Take an initial look at the format of the data available.

```{r Glimpse}

tt %>% 
  map(glimpse)

```

# Wrangle

Explore the data and process it into a nice format for plotting! Access each dataset by name by using a dollarsign after the `tt` object and then the name of the data set.

```{r Wrangle}

drivers <- tt$drivers
records <- tt$records

# How did the world records develop over time?
drivers %>%
  ggplot(aes(year, records)) +
  geom_bar(stat = "identity") +
  labs( y = "Number of world Records") +
  scale_x_continuous( breaks = seq(1997, 2021, 3),
                      minor_breaks = FALSE)

# Which track is the fastest?
records_time <- records %>% count(track, time) %>% 
  group_by(track) %>% 
  summarize(mean_time = mean(time),
            min_time = min(time),
            range_time = max(time)-min(time)) %>% 
  ungroup()

## mean world records
records_time %>% 
  mutate(track = fct_reorder(track, -mean_time)) %>% 
  ggplot(aes(mean_time, track, fill = track)) +
  geom_col() +
  theme(legend.position = "none") +
  labs(x = "Mean of world records in seconds since 1997",
       y = "Tracks")
# world record per track
records_time %>%
  mutate(track = fct_reorder(track, -min_time)) %>% 
  ggplot(aes(min_time, track, fill = track)) +
  geom_col() +
  theme(legend.position = "none") +
  scale_x_continuous(breaks = seq(0,55,5),
                     minor_breaks = NULL)+
  labs(x = "World records in seconds",
       y = "Tracks",
       title =  "World record (secs) per track")

#For which track did the world record improve the most?
records_time %>% 
  mutate(track = fct_reorder(track, range_time)) %>% 
  ggplot(aes(range_time, track, fill=track)) +
  geom_col() +
  theme(legend.position = "none")

# Who is the player with the most world records?
drivers %>% count(player, year, records) %>% 
  group_by(player) %>% 
  summarize(total_records = sum(records, na.rm = T),
            .groups = "drop" ) %>%  
  arrange(-total_records) %>% 
  filter(total_records > 50) %>% 
  mutate(player=fct_reorder(player, total_records),
         year = year )  %>% 
  ggplot(aes(total_records, player)) +
  geom_col()

drivers %>% count(nation, sort = T) %>% 
  mutate(nation = fct_reorder(nation, n)) %>% 
  ggplot(aes(n, nation)) +
  geom_col()
```


# Visualize

Using your processed dataset, create your unique visualization.

```{r Visualize}


  
```

# Save Image

Save your image for sharing. Be sure to use the `#TidyTuesday` hashtag in your post on twitter! 

```{r}

# This will save your most recent plot
ggsave(
  filename = "My TidyTuesday Plot.png",
  device = "png")

```
